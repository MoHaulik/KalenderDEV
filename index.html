<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar with Todo Features</title>
    <style>
        /* Base styles */
        :root {
            --primary-color: #4a90e2;
            --need-todo-color: #ff5252;
            --nice-todo-color: #4caf50;
            --background-color: #1a1a1a;
            --text-color: #ffffff;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        /* View containers */
        .view-container {
            display: none;
            height: 100vh;
            width: 100vw;
        }

        .active-view {
            display: block;
        }

        /* Calendar container */
        .calendar-container {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Header styles */
        #header-calendar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        #date-container-calendar {
            display: flex;
            flex-direction: column;
        }

        #date-calendar {
            font-size: 2em;
            font-weight: bold;
        }

        #month-name-calendar {
            font-size: 1.2em;
            color: var(--primary-color);
        }

        #day-name-calendar {
            font-size: 1.1em;
            color: #888;
        }

        /* Editor styles */
        #editor-calendar {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 20px;
            min-height: 300px;
            outline: none;
            font-size: 1.1em;
            line-height: 1.6;
        }

        /* Enhanced Todo Styles */
        .todo-item {
            position: relative;
            padding: 8px 12px;
            margin: 8px 0;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .need-to-do {
            background: rgba(255, 82, 82, 0.15);
            box-shadow: 0 0 15px rgba(255, 82, 82, 0.3);
            text-shadow: 0 0 10px rgba(255, 82, 82, 0.5);
        }

        .need-to-do::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 82, 82, 0.15);
            border-radius: 6px;
            animation: pulse 2s infinite;
            z-index: -1;
        }

        .need-to-do::after {
            content: '‚ùó';
            position: absolute;
            left: -20px;
            animation: shake 1s infinite;
        }

        .nice-to-do {
            background: rgba(76, 175, 80, 0.15);
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.2);
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 0.6;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 0.6;
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        /* Timer styles */
        .timer-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .progress-ring {
            width: 200px;
            height: 200px;
        }

        .progress-ring circle {
            fill: none;
            stroke: #ddd;
            stroke-width: 5;
        }

        .progress-ring circle.progress {
            stroke: var(--primary-color);
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 0.3s;
        }

        /* Mode indicators */
        .mode-indicators {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .mode-indicator {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--primary-color);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        /* Navigation */
        .nav-button-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 20px;
        }

        .nav-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: background 0.3s;
        }

        .nav-button.active {
            background: var(--primary-color);
        }

        /* Avatar box */
        .avatar-box {
            position: fixed;
            bottom: 20px;
            right: 20px;
            cursor: pointer;
        }

        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            overflow: hidden;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .text-bubble {
            display: none;
            position: absolute;
            bottom: 60px;
            right: 0;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
            max-width: 200px;
        }

        .avatar-box:hover .text-bubble {
            display: block;
        }
    </style>
</head>
<body>
    <div id="calendar-view" class="view-container active-view">
        <div class="calendar-container">
            <div id="header-calendar">
                <div id="date-container-calendar">
                    <div id="date-calendar"></div>
                    <div id="month-name-calendar"></div>
                </div>
                <div id="day-name-calendar"></div>
            </div>
            <div id="editor-calendar" contenteditable="true"></div>
        </div>
        <div class="avatar-box" onclick="openChat()">
            <div class="avatar">
                <img src="Avatar.jpeg" alt="Avatar">
            </div>
            <div id="greeting-message-calendar" class="text-bubble"></div>
        </div>
    </div>

    <div id="timer-view" class="view-container">
        <div class="timer-container">
            <svg class="progress-ring" viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45"></circle>
                <circle class="progress" cx="50" cy="50" r="45"></circle>
            </svg>
            <div class="mode-indicators">
                <div class="mode-indicator" style="top: 15%; left: 50%;"></div>
                <div class="mode-indicator" style="top: 50%; right: 15%;"></div>
                <div class="mode-indicator" style="bottom: 15%; left: 50%;"></div>
            </div>
            <div class="knob"></div>
            <div class="display">--:--</div>
            <div class="mode-name"></div>
        </div>
    </div>

    <div class="nav-button-container">
        <div id="btn-calendar" class="nav-button active" aria-label="Calendar View"></div>
        <div id="btn-timer" class="nav-button" aria-label="Timer View"></div>
    </div>

    <script>
        // Initialize date display
        function updateDate() {
            const now = new Date();
            const dateEl = document.getElementById('date-calendar');
            const monthEl = document.getElementById('month-name-calendar');
            const dayEl = document.getElementById('day-name-calendar');

            dateEl.textContent = now.getDate();
            monthEl.textContent = now.toLocaleString('default', { month: 'long' });
            dayEl.textContent = now.toLocaleString('default', { weekday: 'long' });
        }

        // Process editor content
        function processEditorContent(editor) {
            const content = editor.innerHTML;
            const lines = content.split('<br>');
            
            const processedLines = lines.map(line => {
                const trimmedLine = line.trim();
                if (trimmedLine.startsWith('!')) {
                    return `<div class="todo-item need-to-do">${trimmedLine.substring(1)}</div>`;
                } else if (trimmedLine.startsWith('.')) {
                    return `<div class="todo-item nice-to-do">${trimmedLine.substring(1)}</div>`;
                }
                return line;
            });
            
            return processedLines.join('<br>');
        }

        // Initialize editor functionality
        function initializeEditor() {
            const editor = document.getElementById('editor-calendar');
            
            editor.addEventListener('input', (e) => {
                const selection = window.getSelection();
                const range = selection.getRangeAt(0);
                const startOffset = range.startOffset;
                
                const processedContent = processEditorContent(editor);
                
                if (processedContent !== editor.innerHTML) {
                    editor.innerHTML = processedContent;
                    
                    const newRange = document.createRange();
                    newRange.setStart(editor.firstChild, startOffset);
                    newRange.collapse(true);
                    selection.removeAllRanges();
                    selection.addRange(newRange);
                }
            });
            
            if (editor.innerHTML.trim()) {
                editor.innerHTML = processEditorContent(editor);
            }
        }

        // View switching
        function switchView(viewId) {
            document.querySelectorAll('.view-container').forEach(view => {
                view.classList.remove('active-view');
            });
            document.getElementById(viewId).classList.add('active-view');
            
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`btn-${viewId.split('-')[0]}`).classList.add('active');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateDate();
            initializeEditor();
            
            // Set up view switching
            document.getElementById('btn-calendar').addEventListener('click', () => switchView('calendar-view'));
            document.getElementById('btn-timer').addEventListener('click', () => switchView('timer-view'));
        });

        // Chat functionality
        function openChat() {
            // Implement chat functionality here
            console.log('Opening chat...');
        }

        // Update date every minute
        setInterval(updateDate, 60000);
    </script>
</body>
</html>
